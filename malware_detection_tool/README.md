
# Malware Detection Tool

This tool scans directories for malware based on a signature database of known hashes. It provides options for directory scanning, real-time monitoring, and creating signature databases, making it a versatile utility for detecting malicious files.

## Features
- **Directory Scanning**: Scans a specified directory for files matching known malware signatures.
- **Real-Time Monitoring**: Monitors a directory for changes and detects malware in real-time.
- **Signature Database Creation**: Generates a malware signature database with randomly generated hashes for testing.

## Requirements
- **Python 3.x**
- **watchdog** : pip install watchdog
```

## File Structure

```plaintext
malware_detection_tool/
│
├── main.py                    # Main script for running the tool
├── malware_signatures.txt     # Signature database (generated by tool)
│
├── utils/                      # Utility modules
│   ├── hashing.py              # Functions for hashing and signature handling
│   └── file_utils.py           # Functions for file handling and quarantine
│
└── tasks/                      # Task-specific functionality
    ├── task_a.py               # Signature creation and malware detection
    ├── task_b.py               # Directory scanning and quarantine
    └── task_c.py               # Real-time monitoring
```

## Usage

### 1. Generate a Signature Database
To create a signature database (`malware_signatures.txt`) with randomly generated hashes for testing, use the `--create-signature-db` option:
```bash
python main.py --create-signature-db
```
This command generates the `malware_signatures.txt` file in the root directory.

### 2. Run a Directory Scan
Scan a specified directory for files that match the signatures in `malware_signatures.txt`. You must specify the directory to scan, the signature database, and an output log file.

```bash
python main.py -d <directory_to_scan> -s malware_signatures.txt -o detection_log.txt
```

**Example:**
```bash
python main.py -d test_directory -s malware_signatures.txt -o detection_log.txt
```

- This command will scan `test_directory`, check each file against `malware_signatures.txt`, and write the results to `detection_log.txt`.

### 3. Enable Real-Time Monitoring
To monitor a directory in real-time and automatically quarantine detected files, use the `-r` flag:

```bash
python main.py -d <directory_to_monitor> -s malware_signatures.txt -o detection_log.txt -r
```

**Example:**
```bash
python main.py -d test_directory -s malware_signatures.txt -o detection_log.txt -r
```

With this command, the tool will watch `test_directory` for any file additions or modifications and scan each one in real-time.

### 4. Validate Hashes of a Specific File
To check multiple hash values (MD5, SHA1, SHA256, SHA512) of a single file, use the `--validate-hashes` option:

```bash
python main.py --validate-hashes <path_to_file>
```

**Example:**
```bash
python main.py --validate-hashes test_directory/sample_file.txt
```

This command prints the MD5, SHA1, SHA256, and SHA512 hashes of `sample_file.txt`, useful for verifying file integrity across different hash algorithms.

## Log Output
All scan results, including detected malware and quarantined files, are written to the specified log file (e.g., `detection_log.txt`). Each entry in the log includes the timestamp and path of any detected malware.

## Example Workflow

1. **Generate Signatures**:

   python main.py --create-signature-db


2. **Scan Directory**:

   python main.py -d test_directory -s malware_signatures.txt -o detection_log.txt


3. **Enable Real-Time Monitoring**:

   python main.py -d test_directory -s malware_signatures.txt -o detection_log.txt -r


