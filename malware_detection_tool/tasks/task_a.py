from utils.hashing import create_hashes, load_signatures
import random
from datetime import datetime

# Task A1: Create Signature Database
def create_signature_database(file_path, num_entries=50):
    malware_types = ['Worm', 'Ransomware', 'Virus', 'Spyware', 'Adware']
    severity_levels = ['Low', 'Medium', 'High', 'Critical']
    
    with open(file_path, 'w') as f:
        f.write("MD5 Hash | SHA256 Hash | Malware Type | Infection Date | Severity Level\n")
        for _ in range(num_entries):
            text = ''.join(random.choices("abcdefghijklmnopqrstuvwxyz", k=10))
            md5, sha256 = create_hashes(text)
            malware_type = random.choice(malware_types)
            infection_date = datetime.now().strftime('%Y-%m-%d')
            severity = random.choice(severity_levels)
            f.write(f"{md5} | {sha256} | {malware_type} | {infection_date} | {severity}\n")

# Task A2: Detect Malware
def detect_malware(signatures, text):
    md5, sha256 = create_hashes(text)
    return (md5, sha256) in signatures

# Task A3: Multi-Hash Validation
def multi_hash_validation(text):
    md5, sha1, sha256, sha512 = create_hashes(text, multi=True)
    print(f"MD5: {md5}, SHA1: {sha1}, SHA256: {sha256}, SHA512: {sha512}")

if __name__ == "__main__":
    create_signature_database()