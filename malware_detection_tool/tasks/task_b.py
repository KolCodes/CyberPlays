import os
from datetime import datetime
from utils.hashing import create_hashes
from utils.file_utils import quarantine_file

def scan_directory(directory, signatures, log_file):
    with open(log_file, 'w') as log:
        for root, _, files in os.walk(directory):
            for file in files:
                file_path = os.path.join(root, file)
                with open(file_path, 'rb') as f:
                    data = f.read().decode(errors='ignore')
                    if detect_malware(signatures, data):
                        log.write(f"{datetime.now()} - Malware detected: {file} in {file_path}\n")
                        quarantine_file(file_path)
