import argparse
from tasks import task_a, task_b, task_c

def main():
    parser = argparse.ArgumentParser(description="Malware Detection Tool")
    parser.add_argument('-d', '--directory', required=True, help="Directory to scan")
    parser.add_argument('-s', '--signature', required=True, help="Path to signature file")
    parser.add_argument('-o', '--output', required=True, help="Output log file")
    parser.add_argument('-r', '--realtime', action='store_true', help="Enable real-time monitoring")
    args = parser.parse_args()
    
    # Load signatures
    signatures = task_a.load_signatures(args.signature)

    if args.realtime:
        task_c.monitor_directory(args.directory, signatures, args.output)
    else:
        task_b.scan_directory(args.directory, signatures, args.output)

if __name__ == "__main__":
    main()
